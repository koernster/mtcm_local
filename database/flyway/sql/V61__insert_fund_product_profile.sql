-- Insert or update default product profile for Fund product type
-- Uses the same producttypeid as defined in V54 for 'Fund'
-- Uses UPSERT pattern: inserts if not exists, updates if exists

INSERT INTO productprofiles (producttypeid, profileconfig)
VALUES (
    'b2c3d4e5-2222-4f6a-9b0c-2d3e4f5a6b03'::UUID,
    '{"tabs":[{"id":"basic-product-info","name":"Basic Product Info","sections":[{"id":"investment-type","grid":2,"type":"fields","fields":[{"key":"investtypeid","name":"investmentType","alias":"Investment Type","options":{"source":"investmentTypes","labelKey":"typename","valueKey":"id"},"position":1,"fieldInfo":"Choose the type of investment product.","excludeValues":["Basket"],"reactComponent":"SelectInput"}]},{"id":"basket-assets","type":"custom","showWhen":{"field":"investmenttype.typename","equals":"Basket"},"customComponent":"BasketAssetsSection"},{"id":"dates","grid":2,"type":"fields","fields":[{"key":"issuedate","name":"issueDate","alias":"Issue Date","position":1,"required":true,"fieldInfo":"The date when the product will be issued.","reactComponent":"DateInput"},{"key":"maturitydate","name":"maturityDate","alias":"Maturity Date","position":2,"required":true,"fieldInfo":"The date when the product matures.","reactComponent":"DateInput"}]},{"id":"coupon-details","grid":2,"type":"fields","fields":[{"key":"coponfreqid","name":"couponFrequency","alias":"Coupon Frequency","options":{"source":"couponFrequencies","labelKey":"frequency","valueKey":"id"},"position":1,"fieldInfo":"Choose the frequency of coupon payments.","reactComponent":"SelectInput"},{"key":"copontypeid","name":"couponType","alias":"Coupon Type","options":{"source":"couponTypes","labelKey":"typename","valueKey":"id"},"position":2,"fieldInfo":"Select whether the coupon type is fixed or floating.","reactComponent":"SelectInput"}]}]},{"id":"parties-involved","name":"Parties Involved","sections":[{"id":"parties-row-1","grid":2,"type":"fields","fields":[{"key":"agenttypeid","name":"payingAgent","alias":"Paying Agent","options":{"source":"payAgentTypes","labelKey":"typename","valueKey":"id"},"position":1,"fieldInfo":"Select the paying agent for the product.","reactComponent":"SelectInput"},{"key":"broker","name":"broker","alias":"Broker","props":{"placeholder":"Enter broker name"},"position":2,"fieldInfo":"","reactComponent":"TextInput"}]},{"id":"parties-row-2","grid":2,"type":"fields","fields":[{"key":"trustee","name":"trustee","alias":"Trustee","props":{"placeholder":"Enter trustee name"},"position":1,"fieldInfo":"","reactComponent":"TextInput"},{"key":"custodianid","alias":"Custodian","fieldInfo":"Search and select custodian","autocomplete":{"labelKey":"custodianname","valueKey":"id","minLength":2,"placeholder":"Search custodians...","searchMethod":"searchCustodians","searchService":"CustodianService"},"reactComponent":"AutocompleteInput"}]}]},{"id":"fin-structure","name":"Financial Structure","sections":[{"id":"isins","type":"custom","customComponent":"ISINsSection"},{"id":"subscription-date","grid":2,"type":"fields","fields":[{"key":"subscriptiondate","name":"subscriptionDate","alias":"Final Subscription Date","colSize":6,"position":1,"fieldInfo":"Last date for accepting subscriptions","reactComponent":"DateInput"}]},{"id":"trade-amounts","grid":2,"type":"fields","fields":[{"key":"mintradeamt","name":"minTradeAmount","alias":"Minimum Trade Amount","props":{"min":100000,"currency":"CHF","showSymbol":true},"position":1,"fieldInfo":"Specify trade amount. Minimum 100k of currency.","reactComponent":"CurrencyInput"},{"key":"mintradelot","name":"minTradeLot","alias":"Minimum Trading Lot","props":{"placeholder":"Enter trading lot details"},"position":2,"fieldInfo":"Define trading lot specifications.","reactComponent":"TextInput"}]}]},{"id":"fees-costs","name":"Fees and Costs","sections":[{"id":"fees","type":"custom","customComponent":"FeesSection"},{"id":"costs","type":"custom","customComponent":"CostsSection"},{"id":"subscription-costs","type":"custom","customComponent":"SubscriptionCostsSection"}]},{"id":"key-dates","name":"Key Dates & Schedules","sections":[{"id":"coupon-schedule","grid":2,"type":"fields","fields":[{"key":"coponpaymentscheduleid","name":"couponPaymentSchedule","alias":"Coupon Payment Schedule","options":{"source":"scheduleTypes","labelKey":"typename","valueKey":"id"},"position":1,"fieldInfo":"Define how often coupon payments will be made.","reactComponent":"SelectInput"},{"key":"coponpaymentdate","name":"couponPaymentDate","alias":"Coupon Payment Date","position":2,"fieldInfo":"","reactComponent":"DateInput"}]},{"id":"redemption","grid":2,"type":"fields","fields":[{"key":"earlyredemptiondate","name":"earlyRedemptionDate","alias":"Early Redemption Date","colSize":6,"position":1,"fieldInfo":"Specify the earliest date when the product can be redeemed.","reactComponent":"DateInput"}]}]}],"rules":{},"productName":"Fund"}'::JSONB
)
ON CONFLICT (producttypeid) DO UPDATE 
SET profileconfig = EXCLUDED.profileconfig;
